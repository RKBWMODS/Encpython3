<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C PYTHON <= - Enkripsi Modern</title>
    <!-- Sertakan PyScript (gunakan versi rilis tertentu untuk stabilitas) -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2022.12.1/pyscript.css" />
    <script defer src="https://pyscript.net/releases/2022.12.1/pyscript.js"></script>
    <style>
      /* Latar belakang gradient animasi */
      body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        font-family: 'Roboto', sans-serif;
        color: #fff;
        background: linear-gradient(45deg, #1f4037, #99f2c8);
        background-size: 400% 400%;
        animation: gradientBG 15s ease infinite;
      }
      @keyframes gradientBG {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      /* Container utama dengan animasi fadeIn */
      .container {
        background: rgba(0, 0, 0, 0.7);
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.8);
        width: 90%;
        max-width: 800px;
        position: relative;
        overflow: hidden;
        animation: fadeIn 1s ease;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      h2 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 2.5em;
        letter-spacing: 2px;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
      }
      textarea {
        width: 100%;
        height: 200px;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        padding: 15px;
        color: #fff;
        font-family: 'Courier New', monospace;
        font-size: 1em;
        transition: border 0.3s ease, transform 0.3s ease;
      }
      textarea:focus {
        border-color: #00e676;
        transform: scale(1.02);
      }
      button {
        display: inline-block;
        background: linear-gradient(45deg, #00e676, #00bfa5);
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        color: #fff;
        font-size: 1.2em;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        margin-top: 15px;
      }
      button:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(0, 230, 118, 0.7);
      }
      .result-section {
        margin-top: 25px;
      }
      .result-section h3 {
        text-align: center;
        margin-bottom: 10px;
        font-size: 1.5em;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
      }
      #output {
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        padding: 15px;
        min-height: 120px;
        font-family: 'Courier New', monospace;
        font-size: 1em;
        word-wrap: break-word;
        white-space: pre-wrap;
        overflow-y: auto;
        max-height: 300px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: background 0.3s ease;
      }
      #output:hover {
        background: rgba(0, 0, 0, 0.7);
      }
      .copy-button {
        background: linear-gradient(45deg, #ff5252, #ff1744);
        margin-top: 15px;
      }
      .copy-button:hover {
        transform: scale(1.05);
        box-shadow: 0 0 15px rgba(255, 82, 82, 0.7);
      }
      /* Spinner loading */
      .spinner {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50px;
        height: 50px;
        border: 6px solid rgba(255, 255, 255, 0.3);
        border-top: 6px solid #00e676;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        display: none;
        z-index: 10;
      }
      @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="spinner" id="spinner"></div>
      <h2>CTHON <=</h2>
      <textarea id="codeInput" placeholder="Tempel script Python di sini..."></textarea>
      <button id="encryptButton" disabled>ENC GAS</button>
      <div class="result-section">
        <h3>HASIL ENCRIPT DI TAMPILKAN DI BAWAH INI</h3>
        <div id="output"></div>
        <button id="copyButton" class="copy-button">COPY</button>
      </div>
    </div>

    <!-- PyScript: Kode Python untuk enkripsi dan obfuscation dengan pesan debug -->
    <py-script>
import asyncio
import uuid
import js

async def main():
    # Nonaktifkan tombol ENC GAS sampai pustaka siap
    js.document.getElementById("encryptButton").disabled = True
    try:
        import micropip
        await micropip.install("pyaes")
    except Exception as e:
        print("Error installing pyaes:", e)
    import pyaes

    def pad(data: bytes) -> bytes:
        pad_len = 16 - (len(data) % 16)
        return data + bytes([pad_len] * pad_len)

    key = b"thisisaverysecretkey1234567890ab"
    iv = b"initialvector1234"

    def encrypt_text(plaintext: str) -> str:
        data = plaintext.encode("utf-8")
        padded = pad(data)
        aes = pyaes.AESModeOfOperationCBC(key, iv=iv)
        encrypted = aes.encrypt(padded)
        return encrypted.hex()

    def obfuscate_code(plaintext: str) -> str:
        encrypted_hex = encrypt_text(plaintext)
        header = (
            "pyobfuscate=(lambda getattr:[((lambda IIlII,IlIIl:setattr(__builtins__,IIlII,IlIIl)) "
            "for IIlII,IlIIl in getattr.items()]);Il=chr(114)+chr(101);lI=r'[^a-zA-Z0-9]';"
            "lIl=chr(115)+chr(117)+chr(98);lllllllllllllll,llllllllllllllI,lllllllllllllIl,lllllllllIIllIIlI = __import__,getattr,bytes,exec\n\n"
            "__import__(\"sys\").setrecursionlimit(100000000);"
        )
        return header + encrypted_hex

    def on_encrypt(event):
        try:
            spinner = js.document.getElementById("spinner")
            spinner.style.display = "block"
            # Tampilkan pesan debug di output
            js.document.getElementById("output").innerText = "DEBUG: Processing input..."
            code = js.document.getElementById("codeInput").value
            if not code.strip():
                js.document.getElementById("output").innerText = "Input kosong!"
                spinner.style.display = "none"
                return
            print("DEBUG: Button ENC GAS diklik. Input:", code)
            obfuscated = obfuscate_code(code)
            js.document.getElementById("output").innerText = obfuscated
            spinner.style.display = "none"
        except Exception as e:
            js.document.getElementById("output").innerText = "Error: " + str(e)
            spinner.style.display = "none"
            print("Error in on_encrypt:", e)

    js.document.getElementById("encryptButton").addEventListener("click", on_encrypt)
    js.document.getElementById("encryptButton").disabled = False

asyncio.ensure_future(main())
    </py-script>

    <!-- Script untuk fungsi COPY -->
    <script>
      document.getElementById("copyButton").addEventListener("click", function() {
        const output = document.getElementById("output").innerText;
        if (output.trim() === "") {
          alert("Tidak ada hasil enkripsi untuk disalin.");
          return;
        }
        navigator.clipboard.writeText(output)
          .then(() => alert("Hasil enkripsi telah disalin!"))
          .catch(err => alert("Gagal menyalin: " + err));
      });
    </script>
  </body>
</html>
